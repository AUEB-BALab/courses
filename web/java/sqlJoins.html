<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Inner TITLE_HERE Outer Joins and Aggregates</title>

    <!-- Bootstrap -->
    <!-- JQuery is required -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="../css/pandoc-syntax.css">
  </head>
  <body>
<h1 id="coding-bootcamp-inner-outer-joins-and-aggregates">Coding Bootcamp: Inner &amp; Outer Joins and Aggregates</h1>
<h2 id="sql-joins">SQL Joins</h2>
<h2 id="seleect-statement">SELEECT Statement</h2>
<ul>
<li>A business needs to organize its information</li>
<li>Database solution<br />
<img src="media/statement.png" /></li>
</ul>
<h2 id="where-clause">WHERE Clause</h2>
<ul>
<li>The WHERE clause is used to filter records</li>
</ul>
<p>SQL WHERE Syntax</p>
<pre><code>SELECT column_name,column_name
FROM table_name
WHERE column_name operator value;</code></pre>
<h2 id="where-clause-1">WHERE Clause</h2>
<p>Example</p>
<pre><code>SELECT *
FROM Customers
WHERE Country=&#39;Mexico&#39;;</code></pre>
<h2 id="group-by-statement">GROUP BY Statement</h2>
<ul>
<li>Is used in conjunction with the aggregate functions (SUM, COUNT, etc.) to group the result-set by one or more columns</li>
</ul>
<p>SQL GROUP BY Syntax</p>
<pre><code>SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name;</code></pre>
<h2 id="group-by-statement-1">GROUP BY Statement</h2>
<p>Example</p>
<pre><code>SELECT customer_id, count(*) 
FROM Customers 
GROUP BY customer_id;</code></pre>
<h2 id="sql-join">SQL Join</h2>
<ul>
<li>Joining data together is one of the most significant strengths of a relational database</li>
<li>An SQL join is a Structured Query Language (SQL) instruction to combine data from two sets of data (e.g. two tables) as long as they are relations</li>
<li>Tables are “joined” two at a time making a new relation (a table generated on the fly) containing all possible combinations of rows from the original two tables</li>
</ul>
<h2 id="example-1">Example 1</h2>
<p><img src="media/example1.1.png" /></p>
<h2 id="example-1-1">Example 1</h2>
<p><img src="media/example1.2.png" /></p>
<h2 id="example-1---query-1">Example 1 - Query 1</h2>
<p><img src="media/example1.3.png" /></p>
<h2 id="example-1---query-2">Example 1 - Query 2</h2>
<p><img src="media/example1.4.png" /></p>
<h2 id="inner-joining-3-tables">Inner Joining 3 tables</h2>
<pre><code>SELECT *
FROM Student
INNER JOIN Grade
    ON Student.ID = Grade.ID
INNER JOIN Course
    ON Grade.Code = Course.Code;</code></pre>
<h2 id="inner-joining-3-tables-1">Inner Joining 3 tables</h2>
<p><img src="media/example1.5.png" /></p>
<h2 id="example-1---query-2-1">Example 1 - Query 2</h2>
<p><img src="media/example1.6.png" /></p>
<h2 id="example-2">Example 2</h2>
<p><img src="media/example2.1.png" /></p>
<h2 id="example-2---query-1">Example 2 - Query 1</h2>
<p><img src="media/example2.2.png" /></p>
<h2 id="example-2---query-2">Example 2 - Query 2</h2>
<p><img src="media/example2.3.png" /></p>
<h2 id="example-2---query-3">Example 2 - Query 3</h2>
<p><img src="media/example2.4.png" /></p>
<h2 id="example-2---query-4">Example 2 - Query 4</h2>
<p><img src="media/example2.5.png" /></p>
<h2 id="sakila-sample-database">Sakila Sample Database</h2>
<ul>
<li>The Sakila sample database is intended to provide a standard schema that can be used for examples in books, tutorials, articles, samples, and so forth</li>
<li>Available online: <a href="http://dev.mysql.com/doc/sakila/en/" class="uri">http://dev.mysql.com/doc/sakila/en/</a></li>
<li>Download: <a href="http://dev.mysql.com/doc/index-other.html" class="uri">http://dev.mysql.com/doc/index-other.html</a></li>
<li>Direct link: <a href="http://downloads.mysql.com/docs/sakila-db.zip" class="uri">http://downloads.mysql.com/docs/sakila-db.zip</a></li>
</ul>
<h2 id="sakila-sample-database-1">Sakila Sample Database</h2>
<p><img src="media/sakila1.png" /></p>
<h2 id="sakila-sample-database-2">Sakila Sample Database</h2>
<p><img src="media/sakila2.png" /></p>
<h2 id="sakila-sample-database-3">Sakila Sample Database</h2>
<p><img src="media/sakila3.png" /></p>
<h2 id="sakila-sample-database-4">Sakila Sample Database</h2>
<p><img src="media/sakila4.png" /></p>
<h2 id="sakila-sample-database-5">Sakila Sample Database</h2>
<p><img src="media/sakila5.png" /></p>
<h2 id="sakila-sample-database-6">Sakila Sample Database</h2>
<p><img src="media/sakila6.png" /></p>
<h2 id="sakila-sample-database-7">Sakila Sample Database</h2>
<p><img src="media/sakila7.png" /></p>
<h2 id="sakila-sample-database-8">Sakila Sample Database</h2>
<p><img src="media/sakila8.png" /></p>
<h2 id="how-to-see-the-database-schema">How to see the database schema</h2>
<h2 id="data-base-schema-reverse-engineering">Data Base Schema – Reverse Engineering</h2>
<p><img src="media/dbschema1.png" /></p>
<h2 id="data-base-schema-reverse-engineering-1">Data Base Schema – Reverse Engineering</h2>
<p><img src="media/dbschema2.png" /></p>
<h2 id="data-base-schema-reverse-engineering-2">Data Base Schema – Reverse Engineering</h2>
<p><img src="media/dbschema3.png" /></p>
<h2 id="sakila-db-schema">Sakila – DB Schema</h2>
<p><img src="media/dbschema4.png" /></p>
<h2 id="sakila-db-schema-1">Sakila – DB Schema</h2>
<p><img src="media/dbschema5.png" /></p>
<h2 id="exercise-1">Exercise 1</h2>
<ul>
<li><p>What are the names of all the languages in the database (sorted alphabetically)?</p>
<pre><code>SELECT language.name
FROM sakila.language
ORDER BY language.name</code></pre></li>
</ul>
<h2 id="exercise-2">Exercise 2</h2>
<ul>
<li><p>Return the full names (first and last) of actors with “SON” in their last name, ordered by their first name.</p>
<pre><code>select first_name, last_name
from sakila.actor
where  last_name LIKE &#39;%son%‘
order by first_name</code></pre></li>
</ul>
<h2 id="exercise-3">Exercise 3</h2>
<ul>
<li><p>Find all the addresses where the district is empty, and return these addresses sorted by city_id in ascending order</p>
<pre><code>select address
from sakila.address
where district=&#39;&#39; order by city_id asc;</code></pre></li>
</ul>
<h2 id="exercise-4-12">Exercise 4 (1/2)</h2>
<ul>
<li>Display the film title and the film category it belongs to. Return the names of these categories and the name of the film, sorted by the name of the film alphabetically<br />
<img src="media/dbschema1a.png" /></li>
</ul>
<h2 id="exercise-4-22">Exercise 4 (2/2)</h2>
<ul>
<li><p>Display the film title and the film category it belongs to. Return the names of these categories and the name of the film, sorted by the name of the film alphabetically</p>
<pre><code>select film_category.category_id, film.title from film_category
inner join  film 
on film_category.film_id=film.film_id
order by film.title</code></pre></li>
</ul>
<h2 id="exercise-5-12">Exercise 5 (1/2)</h2>
<ul>
<li>Display the film category id and the number of films that belong to each category. Then return the results, sorted by the number of the films that belong to each category<br />
<img src="media/dbschema1b.png" /></li>
</ul>
<h2 id="exercise-5-22">Exercise 5 (2/2)</h2>
<ul>
<li><p>Display the film category id and the number of films that belong to each category. Then return the results, sorted by the number of the films that belong to each category</p>
<pre><code>Select a.category_id, count(a.film_id) as NumberOfFilms
from film_category a
group by a.category_id
order by NumberOfFilms</code></pre></li>
</ul>
<h2 id="exercise-6-12">Exercise 6 (1/2)</h2>
<ul>
<li>Display the film category id that contain more than 50 films. Then return the results, sorted by the number of the films that belong to each category<br />
<img src="media/dbschema1c.png" /></li>
</ul>
<h2 id="exercise-6-22">Exercise 6 (2/2)</h2>
<ul>
<li><p>Display the film category id that contain more than 50 films. Then return the results, sorted by the number of the films that belong to each category</p>
<pre><code>select b.name, count(a.film_id) as NumberOfFilms
from film_category a
inner join category b
on a.category_id=b.category_id
group by a.category_id
having NumberOfFilms&gt;49
order by NumberOfFilms</code></pre></li>
</ul>
<h2 id="exercise-7-12">Exercise 7 (1/2)</h2>
<ul>
<li>Display the film categories (film_category_id) where the average difference between the film replacement cost and the rental rate larger than 17?<br />
<img src="media/dbschema1d.png" /></li>
</ul>
<h2 id="exercise-7-22">Exercise 7 (2/2)</h2>
<ul>
<li><p>Display the film categories (film_category_id) where the average difference between the film replacement cost and the rental rate larger than 17?</p>
<pre><code>select a.category_id, avg(b.replacement_cost - b.rental_rate) dif
from sakila.film_category a
inner join sakila.film b
on a.film_id=b.film_id
group by a.category_id 
having dif&gt; 17</code></pre></li>
</ul>
<h2 id="exercise-8-12">Exercise 8 (1/2)</h2>
<ul>
<li>Create a list of films and their corresponding category names<br />
<img src="media/dbschema1e.png" /></li>
</ul>
<h2 id="exercise-8-22">Exercise 8 (2/2)</h2>
<ul>
<li><p>Create a list of films and their corresponding category names</p>
<pre><code>select  c.`name`, a.title
from    sakila.film a
inner join sakila.film_category b 
on a.film_id=b.film_id
inner join sakila.category c 
on c.category_id=b.category_id</code></pre></li>
</ul>
<h2 id="exercise-9-12">Exercise 9 (1/2)</h2>
<ul>
<li>Display the film categories (names) where the average difference between the film replacement cost and the rental rate larger than 17?<br />
<img src="media/dbschema1f.png" /></li>
</ul>
<h2 id="exercise-9-22">Exercise 9 (2/2)</h2>
<ul>
<li><p>Display the film categories (names) where the average difference between the film replacement cost and the rental rate larger than 17?</p>
<pre><code>select c.name, avg(b.replacement_cost) cost, avg(b.rental_rate) rate
from sakila.film_category a
inner join sakila.film b 
on a.film_id=b.film_id
inner join sakila.category c 
on c.category_id=a.category_id
group by a.category_id 
having cost-rate&gt; 17</code></pre></li>
</ul>
<h2 id="exercise-10-12">Exercise 10 (1/2)</h2>
<ul>
<li>Create a list of actors (id, first, last name) and the number of films by each actor, that have played. Display the results sorted by the number of films each actor has participated in.<br />
<img src="media/dbschema1g.png" /></li>
</ul>
<h2 id="exercise-10-22">Exercise 10 (2/2)</h2>
<ul>
<li><p>Create a list of actors (id, first, last name) and the number of films by each actor, that have played. Display the results sorted by the number of films each actor has participated in.</p>
<pre><code>select a.actor_id, a.first_name, a.last_name, count(b.film_id) as NumberOfFilms
from sakila.actor a
inner join sakila.film_actor b 
on a.actor_id=b.actor_id
group by a.actor_id, a.first_name, a.last_name
order by NumberOfFilms </code></pre></li>
</ul>
<h2 id="exercise-11-12">Exercise 11 (1/2)</h2>
<ul>
<li>Create a list of actors (id, first, last name) and the number of movies by each actor, that have played in movies that had a duration more than 183 minutes. Display the results sorted by the number of films each actor have participated.<br />
<img src="media/dbschema1h.png" /></li>
</ul>
<h2 id="exercise-11-22">Exercise 11 (2/2)</h2>
<ul>
<li><p>Create a list of actors (id, first, last name) and the number of movies by each actor, that have played in movies that had a duration more than 183 minutes. Display the results sorted by the number of films each actor have participated.</p>
<pre><code>select  a.actor_id, a.first_name, a.last_name, count(b.film_id) NumberOfFilms, c.length
from sakila.actor a
inner join sakila.film_actor b 
on a.actor_id=b.actor_id
inner join sakila.film c 
on  c.film_id=b.film_id
where c.length&gt;183
group by a.actor_id, a.first_name, a.last_name
order by NumberOfFilms </code></pre></li>
</ul>
<h2 id="exercise-12-12">Exercise 12 (1/2)</h2>
<ul>
<li>Find the title of English films having category of ‘Documentary’.<br />
<img src="media/dbschema1i.png" /></li>
</ul>
<h2 id="exercise-12-22">Exercise 12 (2/2)</h2>
<ul>
<li><p>Find the title of English films having category of ‘Documentary’.</p>
<pre><code>select c.title
from sakila.category a
inner join sakila.film_category b 
on a.category_id=b.category_id
inner join sakila.film c 
on b.film_id=c.film_id
inner join sakila.language d 
on c.language_id=d.language_id
where a.name=&#39;Documentary&#39; and d.name=&#39;English&#39;</code></pre></li>
</ul>
<h2 id="exercise-13">Exercise 13</h2>
<ul>
<li><p>List the film id and titles of those films that are not in inventory.</p>
<pre><code>select a.film_id, a.title
from sakila.film a
where a.film_id not in (
select b.film_id from sakila.inventory b);</code></pre></li>
</ul>
<h2 id="exercise-14">Exercise 14</h2>
<ul>
<li>Give an interesting query of your own that is not already in the assignment. The query should involve an aggregation operation, and a nested SELECT.</li>
</ul>
<h2 id="from-class-diagram-to-er">From Class Diagram to ER</h2>
<ul>
<li>Construct a Class Diagram</li>
<li>The University of Toronto has several departments. Each department has professors. Professors must be assigned to one, but possibly more departments. At least one professor teaches each course, but a professor may be on sabbatical and not teach any course. Each course may be taught by one professor. We know of the department name, the professor name, the professor id, the course names, the course schedule, the term/year that the course is taught, the departments the professor is assigned to, the department that offers the course.</li>
</ul>
<h2 id="from-class-diagram-to-er-1">From Class Diagram to ER</h2>
<p>Identify Classes &amp; Associations<br />
These are the abstract or physical “things” in our system which we wish to describe. Find all the nouns and noun phrases in the domain descriptions you have obtained through your analysis. Consider these class candidates. The class candidates are departments, professor, course, and course section.<br />
<img src="media/cder1.png" /></p>
<h2 id="from-class-diagram-to-er-2">From Class Diagram to ER</h2>
<p><img src="media/cder3.png" /></p>
<h2 id="from-class-diagram-to-er-3">From Class Diagram to ER</h2>
<p><img src="media/cder4.png" /></p>
<h2 id="from-er-to-db-schema">From ER to DB Schema</h2>
<p><img src="media/cder5.png" /></p>
<h2 id="from-er-to-db-schema-1">From ER to DB Schema</h2>
<p><img src="media/cder6.png" /></p>

<hr />
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </body>
</html>
